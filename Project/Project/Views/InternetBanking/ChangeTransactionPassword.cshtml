@{ ViewBag.Title = "Change Transaction Password";
    Layout = "~/Views/Shared/_Banking.cshtml";
    ViewBag.NavType = "UserLoggedIn";
    ViewBag.Account = Session["Account"];
    }

<h2>Change Transaction Password</h2>

<div style="display: flex; gap: 40px; margin-top: 20px;">
    
    <div style="flex: 1; border-right: 1px solid #ccc; padding-right: 20px;">
        <h4>Security Update</h4>
        <p>Update your transaction password to keep your account secure. Use a strong password that’s hard to guess.</p>
    </div>

 
    <div style="flex: 2;">
        @using (Html.BeginForm("ChangeTransactionPassword", "InternetBanking", FormMethod.Post, new { onsubmit = "return validateTransactionPassword();" }))
        {


                <div class="form-group">
                    <label>Old Transaction Password:</label>
                    <input type="password" name="oldPassword" class="form-control" required />
                </div>

                                <div class="form-group">
                                    <label>New Transaction Password:</label>
                                    <input type="password" name="newPassword" id="newTxnPassword" class="form-control" required oninput="checkTxnStrength(this.value)" />
                                    <small id="txnStrength" class="form-text text-muted"></small>
                                </div>

                                                <div style="margin-top: 15px;">
                                                    <button type="submit" class="btn btn-primary">Change</button>
                                                    <button type="reset" class="btn btn-secondary">Reset</button>
                                                </div>}

        @if (ViewBag.Message != null)
        {
<div class="alert alert-info mt-3">@ViewBag.Message</div>}
    </div>
</div>

@section scripts {
    <script>function checkTxnStrength(password) {
        const strengthText = document.getElementById("txnStrength");
        if (password.length < 6) {
            strengthText.textContent = "Weak (min 6 characters)";
            strengthText.style.color = "red";
        } else if (password.match(/[A-Z]/) && password.match(/[0-9]/) && password.length >= 8) {
            strengthText.textContent = "Strong";
            strengthText.style.color = "green";
        } else {
            strengthText.textContent = "Medium (add uppercase and numbers)";
            strengthText.style.color = "orange";
        }
    }

    function validateTransactionPassword() {
        const newPassword = document.getElementById("newTxnPassword").value;
        if (newPassword.length < 6) {
            alert("New transaction password must be at least 6 characters long.");
            return false;
        }
        return true;
    }</script>
}